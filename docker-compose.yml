version: '3.5'

services:
  busybox:
    container_name: "busybox"
    image: "busybox"
    command: top
    volumes:
      - "./:/deploy:rw"
      - "/etc/dnsmasq.d/:/ipset:rw"
    restart: unless-stopped
    networks:
      extnetwork:
  nginx:
    container_name: "nginx-desktop"
    hostname: nginx-desktop
    image: "openresty/openresty:alpine"
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - "/etc/localtime:/etc/localtime"
      - "/tmp:/tmp"
      - "./nginx/conf/nginx.conf:/usr/local/openresty/nginx/conf/nginx.conf"
      - "./nginx/conf/conf.d:/etc/nginx/conf.d"
      - "./nginx/lua:/usr/local/openresty/nginx/lua"
    networks:
      extnetwork:
        ipv4_address: 172.111.11.24
    restart: unless-stopped
  
networks:
  extnetwork:
    name: "M-desktop-network"
    ipam:
      config:
        - subnet: 172.111.11.0/16
          gateway: 172.111.11.1
